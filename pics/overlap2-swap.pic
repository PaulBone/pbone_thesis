.PS 3.5i
right
boxht = 0.5

define AP { 4 }
define BP { 1 }
define TP { 5 }

define AQ { 2 }
define BQ { 3.5 }
define TQ { 4 }

define AL { 0.25 }
define AH { -0.25 }
define LB { -0.55 }
define LS { -0.60 }

P0: box invis "p" wid 1i
P: box wid TP "pB + pA + pR"

arrow -> from P.sw + (AP, AH) to P.sw + (AP, 0)
arrow -> from P.sw + (BP, AH) to P.sw + (BP, 0)
box invis "A" wid 0.5 with .n at P.sw + (AP - AL, 0)
box invis "B" wid 0.5 with .n at P.sw + (BP - AL, 0)
arrow <-> from P.sw + (0, LB) to P.sw + (BP, LB)
arrow <-> from P.sw + (BP, LB) to P.sw + (AP, LB)
arrow <-> from P.sw + (AP, LB) to P.sw + (TP, LB)
box invis "pB" with .n at P.sw + (BP/2, LS)
box invis "pA" with .n at P.sw + ((AP+BP)/2, LS)
box invis "pR" with .n at P.sw + ((AP+TP)/2, LS)

QQ0: box invis "q" wid 1i with .n at P0.s + (0, -1.5)
QQ: box wid AQ "qA"
define RQ { TQ - AQ }
QQR: box wid RQ "qB + qR" with .w at QQ.w + (AP, 0)

arrow -> from QQR.sw + (0, AH) to QQR.sw + (0, 0)
arrow -> from QQR.sw + (BQ - AQ, AH) to QQR.sw + (BQ - AQ, 0)
box invis "A" wid 0.5 with .n at QQR.sw + (AL, 0)
box invis "B" wid 0.5 with .n at QQR.sw + (BQ - AQ + AL, 0)
arrow <-> from QQ.sw + (0, LB) to QQ.sw + (AQ, LB)
arrow <-> from QQR.sw + (0, LB) to QQR.sw + ((BQ - AQ), LB)
arrow <-> from QQR.sw + ((BQ - AQ), LB) to QQR.se + (0, LB)
box invis "qA" with .n at QQ.sw + (AQ/2, LS)
box invis "qB" with .n at QQR.sw + ((BQ - AQ)/2, LS)
box invis "qR" with .n at QQR.sw + ((BQ - AQ + AQ)/2, LS)
.PE

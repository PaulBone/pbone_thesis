\documentclass[a4paper,twoside]{report}

\title{Automatic Parallelisation for Mercury}
\author{Paul Bone}

% According to gradresearch.unimelb.edu.au:
%
% The dissertation should be roughly 80,000 words and strictly fewer than
% 100,000 words.
%
% Printed on a4 paper.
%
% 1.5 spaced.
%
% Margins no smaller than 30mm.
%
% Page numbers must be consecutive and printed within the margin.
%
% MSGR are flexible WRT citation style, They defer to the department on this
% (as different disciplines have different rules).  I am waiting for Chris
% Leckie to reply to me about this.

% WARNING: citesort, hyperref and algorithm do not play nice together.
% This can be fixed by using natbib (which is apparently better) instead of
% citesort.
% And by using hyperref before algorithm.

\usepackage{hyperref}

% Restart numbering in each chapter.
\usepackage[chapter]{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage[margin=3cm]{geometry}
\usepackage[sort&compress]{natbib}
\usepackage{pstricks}
\usepackage{setspace}
\usepackage{breakurl}
\usepackage{xspace}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{dcolumn}

% If you do not have this package, install texlive-math-extra, I did not want
% to include it in this directory since it brings fonts with it, (and they are
% needed)
\usepackage{stmaryrd}

\usepackage{fancyhdr}
\setlength{\headheight}{15.2pt}
\pagestyle{fancy}
\lhead{}
\rhead{}
\chead{Draft \today,}

\onehalfspacing

\input{macros}

\begin{document}

\begin{titlepage}
\begin{center}
\vspace*{3cm}
{\Huge \textbf{Automatic Parallelisation for}} \par
\vspace*{1em}
{\Huge \textbf{Mercury}} \par
\vspace*{2cm}
{\huge \textbf{Paul Bone}} \par
\vspace*{4cm}
{\Large Submitted in total fulfilment of the requirements of the degree of
        Doctor of Philosophy} \par
\vspace*{1cm}
% XXX: Revise this date.
{\Large April 2012} \par
\vspace*{1cm}
{\Large Department of Computing and Information Systems} \par
{\Large The University of Melbourne} \par
\end{center}

\paul{Copyright (C) 2009-2012 Paul Bone}\\
\paul{Draft \today, not for redistribution.}
\end{titlepage}

\chapter*{Abstract}

\paul{300-500 words}

\chapter*{Declaration}

% This is the prose that gradresearch.unimelb.edu.au said I should use.

This is to certify that:

\begin{itemize}

    \item the thesis comprises only my original work towards the PhD except
          where indicated in the Preface,

    \item due acknowledgement has been made in the text to all other material
          used,

    \item the thesis is fewer than 100,000 words in length, exclusive of
          tables, maps, bibliographies and appendices.

\end{itemize}

\vspace{1em}

\noindent Signed:

\vspace{1em}

\noindent Date:

\chapter*{Preface}

I begun working on automatic parallelism in Mercury as part of my Honours project
for the degree of Bachelor of Computer Science at the University of Melbourne.
This work occurred before my PhD candidature commenced.
It included the profiler feedback framework that is discussed in Section
\ref{sec:background}.
It also includes an initial, rudimentary, version of the automatic
parallelisation tool
(Section \ref{sec:backgnd_priorautopar}
including an algorithm for determining when a sub-computation produces or
consumes a variable (Section \ref{sec:backgnd_var_use_analysis})
and an extension to the deep profiler that enables coverage profiling
(Section \ref{sec:backgnd_coverage}).

Peter Wang and I worked together to implement work stealing for the Mercury
runtime system.
We estimate that Peter contributed 80\% of the work stealing implementation
and that I contributed 20\%.
\paul{I haven't written up this work, I must decide which chapter it belongs
in, maybe it should be part of the background}.

Chapter \ref{chap:overlap} is derived from a journal paper:

% XXX: not really a quote, I want this text to be typeset as a paragraph whose
% indent (not just first line) is larger than normal.

\begin{quote}
Paul Bone, Zoltan Somogyi and Peter Schachte.
Estimating the overlap between dependent computations for automatic
zparallelization.
{\em Theory and Practice of Logic Programming}, 11(4--5):575--591, 2011.
\end{quote}

% Zoltan, Peter and I worked together to develop the overlap algorithm.
% \paul{The basis for this algorithm first appears in Zoltan's Leuven slides}
% The implementation and testing is all my own work.
% Zoltan and Peter assisted me in writing and editing the paper.

Chapter \ref{chap:loop_control} is derived from a conference paper:

\begin{quote}
Paul Bone, Zoltan Somogyi and Peter Schachte.
Controlling Loops in Parallel Mercury Code.
{\em Declarative Aspects and Applications of Multicore Programming},
Philadelphia PA USA, January 2012.
\end{quote}

% Zoltan and I developed the data structures and algorithm.
% 80\% of the implementation is my own work.
% \paul{Zoltan worked on the code generator changes, but are they actually part
% of the research?}
% Zoltan and Peter assisted me in writing and editing the paper.

Chapter \ref{chap:tscope} is derived from a workshop paper:

\begin{quote}
Paul Bone and Zoltan Somogyi
Profiling parallel Mercury programs with ThreadScope.
{\em 21st Workshop on Logic-based methods in Programming Environments},
Lexington KY USA, July 2011.
\end{quote}

% Zoltan provided feedback about my ideas and contributed a number of ideas of
% his own.
% I am the sole author of the implementation.
% Zoltan assisted me in writing and editing the paper.

\chapter*{Contribution to published work form}

\paul{MSGR have a form we have to include here,
I think it is one form per chapter based on published work}

\chapter*{Acknowledgements}

\status{Outline only}

First I will thank my supervisors,
Zoltan,
Peter,
Aaron.
Then close colleagues
Julien, 
Mark, 
Ralph, 
Tibaut,
Matt Guica,
Matt Davis,
Andreas Schutt,
Leslie,
Sebastian.
Other helpful/supportive academics:
Linda Stern,
Bernie Pope,
Harald S{\o}ndergaard,
Lee Naish.
And in general the community in the CIS department for making me feel
welcome and supported with respect to my vision impairment.

Financial contributors.
Australian Postgraduate Award,
NICTA Top-up Scholarship,
Melbourne Abroad Travelling Scholarship (ICLP \& Cambridge),
Google Travel Prize (ICLP \& Cambridge),
Association for Logic Programming (ICLP),
Mercury Project (ICLP) \paul{Zoltan, you gave me some money for ICLP, where did it
come from?},
NICTA (DAMP),
Open Parallel (MW'12).

Simon Marlow (Maybe Simon's family),
Duncan Coutts,
Eric Kow (although he was absent),
Simon Peyton-Jones,
and others who attended the ThreadScope summit in Cambridge.

My friends,
Amanda \& Chas Dean,
Lucas \& Jen Wilson-Richter,
Sarah Simmonds, John Spencer,
Jeff Beinvenu, Mangai Murugappan,
Terry Williamson, Heidi Williams,
Trent Buck for explaining the lambda calculas \emph{at} me,
Tom Wijgers,
Ha Le,
Chris Menz,
Emil Mikulic,
Ben Stewart for shell access on his multicore system early in my work,
Dave Grinton,
Marco Maimone,
Michael Slater,
Geoff Giesemann,
Enzo Reyes,
Dylan Leigh,
Marco Mattiuzzo.

My parents, Keith and Faye Bone,
for teaching me that my vision might be an impairment but should never
be a limitation.
My brother, James Bone, for always having time to listen.
Especially when I use incomprehensible jargon,
also known as \emph{nerd words} while we where growing up.

Finally, Liz Bone my wife,
for her love, patience, understanding and caring
and being generally awesome.


\tableofcontents

\listoffigures

\listoftables

\listofalgorithms

\chapter{Introduction}
\label{chap:intro}
\input{intro}

\section{Parallelism in programming languages}
\label{sec:literature_review}
\input{literature_review}

\chapter{Background}
\paul{XXX: Write Section 2.0}

\section{Mercury}
\label{sec:backgnd_mercury}
\input{backgnd_mercury}

\section{Explicit Parallelism in Mercury}
\label{sec:backgnd_merpar}
\input{backgnd_merpar}

\section{Dependent AND-parallelism in Mercury}
\label{sec:backgnd_deppar}
\input{backgnd_deppar}

\section{Feedback directed Automatic Parallelism in Mercury}
\label{sec:backgnd_autopar}
\input{backgnd_autopar}

\chapter{Runtime system improvements}
\label{chap:rts}
\input{rts}

\chapter{Overlap}
\label{chap:overlap}

\status{This has not been revised since the paper. I have only removed parts
of it to place elsewhere, for example, in the background section.}

\paul{
    Add discussion about how our data-flow analysis does not recognise loops
    since they need to be treated specially.}

\input{overlap}

\chapter{Loop Control}
\label{chap:loop_control}

\status{This has not been revised since the paper. I have only removed parts
of it to place elsewhere, for example, in the background section.}

\paul{
    Add something about updating overlap's cost model, then we need to
    re-evaluate it.}

\input{loop_control}

\chapter{Visualisation}
\label{chap:tscope}

\status{This section needs a lot more work.  But it depends on unfinished
implementation}

\input{tscope}

\chapter{Conclusion}

% Each research chapter contains a discussion of related work.
\status{No plan for this chapter yet}

I guess in this chapter I have to unify the contributions of the other
chapters.
I think that perhaps this chapter could be used to relate the contribution
of the thesis to the rest of the world, providing statements about future
work, and applicability of this work to other languages and systems.

\paul{How do you finish a thesis?}

\bibliographystyle{plainnat}
\bibliography{bib}

\end{document}

